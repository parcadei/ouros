# call-external
# run-async
# Test async external function calls (coroutines)

# === Basic async external call ===
result = await async_call(42)  # pyright: ignore
assert result == 42, 'async_call should return awaited value'

# === Async call with string ===
s = await async_call('hello')  # pyright: ignore
assert s == 'hello', 'async_call should work with strings'

# === Async call with list ===
lst = await async_call([1, 2, 3])  # pyright: ignore
assert lst == [1, 2, 3], 'async_call should work with lists'

# === Multiple async calls ===
a = await async_call(10)  # pyright: ignore
b = await async_call(20)  # pyright: ignore
assert a + b == 30, 'multiple async calls should work'

# === Gather multiple external async calls ===
import asyncio

rele_external(5),def outer():
    def inner():
        nonlocal x
        return x

    inner()
    x = 1


outer()
"""
TRACEBACK:
Traceback (most recent call last):
  File "traceback__nonlocal_unbound.py", line 10, in <module>
    outer()
    ~~~~~~~
  File "traceback__nonlocal_unbound.py", line 6, in outer
    inner()
    ~~~~~~~
  File "traceback__nonlocal_unbound.py", line 4, in inner
    re async_call(100))  # pyright: ignore
assert results == [10, 100], 'gather should work with coroutine that awaits external'


# === Coroutine with multiple nested awaits ===
async def triple_add(a, b, c):
    x = await async_call(aturn x
           ~
NameError: cannot access free variable 'x' where it is not associated with a value in enclosi)
    y = await async_call(b)
    return x + y + c


results = await asyncio.gather(triple_add(1, 2, 3), async_call(50))  # pyright: ignore
assert results == [6, 50], 'gather should work with coroutine with multiple external awnaits'
g scope
"""
